# 大数据环境中的数据验证——以 Apache Spark 和 Great Expectations 为例

> 原文：<https://www.stxnext.com/blog/data-validation-big-data-environment/>

 根据来自 [Domo](https://web-assets.domo.com/blog/wp-content/uploads/2020/08/20-data-never-sleeps-8-final-01-Resize.jpg) 的统计，2020 年，脸书用户每分钟分享 15 万条信息，LinkedIn 用户申请 69444 份工作，Instagram 用户发布 347222 个故事。

考虑到每天使用的数据量巨大，提供高质量的数据在当今世界变得越来越重要。

因为数据被称为“新的石油”，有效地验证它可以决定你的商业想法是否成功。

通过阅读这篇文章，你将知道以下问题的答案:

*   **什么是数据验证？**
*   什么是远大前程，你为什么要关心它？
*   **有哪些基本的远大前程概念？**
*   **什么是《远大前程》的示例用法？**
*   如何用现实生活中的例子写出客户期望？ 

#### 什么是数据验证？

数据验证是确保数据经过数据清理的过程，以确保数据质量，这意味着数据是正确和有用的。数据验证使用例程，通常称为“验证规则”、“验证约束”或“检查例程”他们检查输入系统的数据的正确性、意义和安全性。

数据验证有多种类型，但最常见的有:

*   类型验证—用于检查数据是否属于给定类型，例如，数字是 int 而不是 float
*   范围和约束验证，例如，人的身高小于 300 cm 且大于 0，因为历史上我们可以知道曾经生活过的最高的人短于 300cm；
*   代码和交叉引用验证—给定值在[a，b，c]中；
*   结构化验证(更复杂的验证)；
*   一致性验证，例如，检查销售日期是否在发货日期之前。

术语“数据验证”被理解为许多自动化的、基于规则的过程，旨在识别、移除或标记不正确或错误的数据。由于数据验证的应用，我们获得了一组干净的数据。

数据验证变得至关重要，因为越来越多的公司和组织依赖从不同来源收集的更大、更复杂的数据集来获得洞察力并做出关键的业务决策。

#### 我们的用例:满怀期望地审查数据

出于本文的目的，我们将分析来自伦敦 的 [Airbnb 预订数据。我们将重点关注预订评论，即使 reviews.csv 文件只有 443 MB 大小，也可以让我们看到在 Spark 中使用 Great Expectations(从现在开始我将称之为“GE”)的一些好处。](https://www.kaggle.com/labdmitriy/airbnb)

我们将尝试寻找没有亵渎的列表的评论，这意味着我们需要使用一个简单的亵渎检查器来编写自定义的亵渎期望检查。

首先，我们需要格式化评论文件。它带有用换行符分隔的评论，如下所示: